{"ast":null,"code":"var _jsxFileName = \"C:\\\\xampp\\\\htdocs\\\\ovi_port_website\\\\app\\\\components\\\\Login\\\\LoginComponent.js\";\nvar __jsx = React.createElement;\nimport React, { useRef, useState, useContext } from \"react\";\nimport { Col } from \"react-bootstrap\";\nimport { fetchGraphQL } from \"../HelperFunctions\";\nimport CustomModel from \"../HelperComponents/CustomModel\";\nimport validator from \"validator\";\nimport { useDispatch } from \"react-redux\";\n\nconst LoginComponent = props => {\n  const dispatch = useDispatch();\n  const userEmail = useRef(\"\");\n  const password = useRef(\"\");\n  const {\n    0: modal,\n    1: setModel\n  } = useState({\n    showModal: false,\n    msgHeader: \"\",\n    msgBody: []\n  });\n\n  const handleClose = () => setModel({\n    showModal: false,\n    msgHeader: \"\",\n    msgBody: []\n  });\n\n  const handleShow = (msgHeader, msgBody) => setModel({\n    showModal: true,\n    msgHeader,\n    msgBody\n  });\n\n  function fetchUser() {\n    const query = `\n    {\n      TryLogin(userEmail:\"${userEmail.current.value}\",password: \"${password.current.value}\")\n      }\n    `;\n    fetchGraphQL(query).then(data => {\n      try {\n        let {\n          msg,\n          jwtToken,\n          role\n        } = JSON.parse(data.TryLogin);\n\n        if (msg === \"ok\") {\n          dispatch({\n            type: \"AUTH_USER\",\n            payload: {\n              loggedInUser: userEmail.current.value,\n              jwt: jwtToken,\n              role\n            }\n          });\n          window.location = \"/\"; // handleShow(\"Success\", [\"you're logged in\"]);\n        } else {\n          handleShow(\"Error\", [\"Username or password incorect!!\"]);\n        }\n      } catch (err) {\n        handleShow(\"Error\", [\"Internal Error\"]);\n      } // if (msg === \"ok\") {\n      //   console.log(jwtToken);\n      // }\n\n    }).catch(err => {\n      console.log(err);\n      handleShow(\"Error\", [\"Username or password incorect!!\"]);\n    });\n  }\n\n  function loginMe() {\n    let errMsg = [];\n    if (!validator.isEmail(userEmail.current.value)) errMsg.push(\"Invalid Email\");\n    if (validator.isEmpty(password.current.value)) errMsg.push(\"Password can not be Empty\");\n\n    if (errMsg.length > 0) {\n      handleShow(\"Error\", errMsg);\n    } else {\n      fetchUser();\n    }\n  }\n\n  return __jsx(React.Fragment, null, __jsx(CustomModel, {\n    show: modal.showModal,\n    handleClose: handleClose,\n    msgHeader: modal.msgHeader,\n    msgBody: modal.msgBody,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84\n    },\n    __self: this\n  }), __jsx(Col, {\n    xs: 12,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 90\n    },\n    __self: this\n  }, __jsx(\"h4\", {\n    style: {\n      color: \"#01c851\"\n    },\n    className: \"text-center\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91\n    },\n    __self: this\n  }, \"Login\")), __jsx(Col, {\n    xs: 12,\n    className: \"pt-5\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96\n    },\n    __self: this\n  }, __jsx(\"input\", {\n    type: \"text\",\n    required: true,\n    ref: userEmail,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97\n    },\n    __self: this\n  }), __jsx(\"span\", {\n    className: \"bar\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99\n    },\n    __self: this\n  }), __jsx(\"label\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100\n    },\n    __self: this\n  }, \"Email\"))), __jsx(Col, {\n    xs: 12,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103\n    },\n    __self: this\n  }, __jsx(\"div\", {\n    className: \"group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104\n    },\n    __self: this\n  }, __jsx(\"input\", {\n    type: \"password\",\n    required: true,\n    ref: password,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105\n    },\n    __self: this\n  }), __jsx(\"span\", {\n    className: \"bar\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107\n    },\n    __self: this\n  }), __jsx(\"label\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108\n    },\n    __self: this\n  }, \"Password\"))), __jsx(Col, {\n    xs: 12,\n    className: \"pt-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 111\n    },\n    __self: this\n  }, __jsx(\"button\", {\n    onClick: loginMe,\n    className: \"btn btn-success\",\n    type: \"submit\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112\n    },\n    __self: this\n  }, \"Login\"), __jsx(\"button\", {\n    onClick: props.toggleLogin,\n    className: \"btn btn-success ml-3\",\n    type: \"submit\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115\n    },\n    __self: this\n  }, \"Signup \", __jsx(\"i\", {\n    className: \"fas fa-long-arrow-alt-right\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120\n    },\n    __self: this\n  }))), __jsx(Col, {\n    xs: 12,\n    className: \"mt-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123\n    },\n    __self: this\n  }, __jsx(\"button\", {\n    onClick: props.forgotPassword,\n    className: \"btn btn-outline-ligh\",\n    type: \"submit\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124\n    },\n    __self: this\n  }, \"Forgot Password\")));\n};\n\nexport default LoginComponent;","map":{"version":3,"sources":["C:\\xampp\\htdocs\\ovi_port_website\\app\\components\\Login\\LoginComponent.js"],"names":["React","useRef","useState","useContext","Col","fetchGraphQL","CustomModel","validator","useDispatch","LoginComponent","props","dispatch","userEmail","password","modal","setModel","showModal","msgHeader","msgBody","handleClose","handleShow","fetchUser","query","current","value","then","data","msg","jwtToken","role","JSON","parse","TryLogin","type","payload","loggedInUser","jwt","window","location","err","catch","console","log","loginMe","errMsg","isEmail","push","isEmpty","length","color","toggleLogin","forgotPassword"],"mappings":"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","sourcesContent":["import React, { useRef, useState, useContext } from \"react\";\r\nimport { Col } from \"react-bootstrap\";\r\nimport { fetchGraphQL } from \"../HelperFunctions\";\r\nimport CustomModel from \"../HelperComponents/CustomModel\";\r\nimport validator from \"validator\";\r\nimport { useDispatch } from \"react-redux\";\r\n\r\nconst LoginComponent = props => {\r\n  const dispatch = useDispatch();\r\n  const userEmail = useRef(\"\");\r\n  const password = useRef(\"\");\r\n  const [modal, setModel] = useState({\r\n    showModal: false,\r\n    msgHeader: \"\",\r\n    msgBody: []\r\n  });\r\n\r\n  const handleClose = () =>\r\n    setModel({\r\n      showModal: false,\r\n      msgHeader: \"\",\r\n      msgBody: []\r\n    });\r\n  const handleShow = (msgHeader, msgBody) =>\r\n    setModel({\r\n      showModal: true,\r\n      msgHeader,\r\n      msgBody\r\n    });\r\n\r\n  function fetchUser() {\r\n    const query = `\r\n    {\r\n      TryLogin(userEmail:\"${userEmail.current.value}\",password: \"${password.current.value}\")\r\n      }\r\n    `;\r\n    fetchGraphQL(query)\r\n      .then(data => {\r\n        try {\r\n          let { msg, jwtToken, role } = JSON.parse(data.TryLogin);\r\n          if (msg === \"ok\") {\r\n            dispatch({\r\n              type: \"AUTH_USER\",\r\n              payload: {\r\n                loggedInUser: userEmail.current.value,\r\n                jwt: jwtToken,\r\n                role\r\n              }\r\n            });\r\n            window.location = \"/\";\r\n            // handleShow(\"Success\", [\"you're logged in\"]);\r\n          } else {\r\n            handleShow(\"Error\", [\"Username or password incorect!!\"]);\r\n          }\r\n        } catch (err) {\r\n          handleShow(\"Error\", [\"Internal Error\"]);\r\n        }\r\n        // if (msg === \"ok\") {\r\n        //   console.log(jwtToken);\r\n        // }\r\n      })\r\n      .catch(err => {\r\n        console.log(err);\r\n        handleShow(\"Error\", [\"Username or password incorect!!\"]);\r\n      });\r\n  }\r\n\r\n  function loginMe() {\r\n    let errMsg = [];\r\n    if (!validator.isEmail(userEmail.current.value))\r\n      errMsg.push(\"Invalid Email\");\r\n    if (validator.isEmpty(password.current.value))\r\n      errMsg.push(\"Password can not be Empty\");\r\n\r\n    if (errMsg.length > 0) {\r\n      handleShow(\"Error\", errMsg);\r\n    } else {\r\n      fetchUser();\r\n    }\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <CustomModel\r\n        show={modal.showModal}\r\n        handleClose={handleClose}\r\n        msgHeader={modal.msgHeader}\r\n        msgBody={modal.msgBody}\r\n      />\r\n      <Col xs={12}>\r\n        <h4 style={{ color: \"#01c851\" }} className=\"text-center\">\r\n          Login\r\n        </h4>\r\n      </Col>\r\n      <Col xs={12} className=\"pt-5\">\r\n        <div className=\"group\">\r\n          <input type=\"text\" required ref={userEmail} />\r\n          {/* <span class=\"highlight\" /> */}\r\n          <span className=\"bar\" />\r\n          <label>Email</label>\r\n        </div>\r\n      </Col>\r\n      <Col xs={12}>\r\n        <div className=\"group\">\r\n          <input type=\"password\" required ref={password} />\r\n          {/* <span class=\"highlight\" /> */}\r\n          <span className=\"bar\" />\r\n          <label>Password</label>\r\n        </div>\r\n      </Col>\r\n      <Col xs={12} className=\"pt-3\">\r\n        <button onClick={loginMe} className=\"btn btn-success\" type=\"submit\">\r\n          Login\r\n        </button>\r\n        <button\r\n          onClick={props.toggleLogin}\r\n          className=\"btn btn-success ml-3\"\r\n          type=\"submit\"\r\n        >\r\n          Signup <i className=\"fas fa-long-arrow-alt-right\" />\r\n        </button>\r\n      </Col>\r\n      <Col xs={12} className=\"mt-3\">\r\n        <button\r\n          onClick={props.forgotPassword}\r\n          className=\"btn btn-outline-ligh\"\r\n          type=\"submit\"\r\n        >\r\n          Forgot Password\r\n        </button>\r\n      </Col>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default LoginComponent;\r\n"]},"metadata":{},"sourceType":"module"}