{"ast":null,"code":"import _JSON$stringify from \"@babel/runtime-corejs2/core-js/json/stringify\";\nimport _JSXStyle from \"styled-jsx/style\";\nvar __jsx = React.createElement;\nimport React, { useState, useRef } from \"react\";\nimport \"../static/styles/_contactForm.scss\";\nimport BaseLayout from \"../components/BaseLayout\";\nimport { Row, Col, Spinner } from \"react-bootstrap\";\nimport validator from \"validator\";\nimport fetch from \"isomorphic-unfetch\";\nimport { useSelector } from \"react-redux\";\n\nfunction createHTMLMail(name, email, msg) {\n  return `\n    <br/><br/>\n    &nbsp;&nbsp;&nbsp;<h3>New Email from: ${name.toUpperCase()}</h3>\n    <h3>Email: ${email}</h3>\n    <br/><br/>\n    Message:\n    <div>${msg}</div>\n    \n\n    <br/> <br/>\n    `;\n}\n\nasync function sendMail(data) {\n  return fetch(\"/api/sendMail\", {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    body: _JSON$stringify({\n      payload: {\n        data\n      }\n    })\n  }).then(r => r.json()).then(data => {\n    return data;\n  });\n}\n\nconst Contact = () => {\n  const {\n    0: err,\n    1: setError\n  } = useState([]);\n  const {\n    0: isSendingEmail,\n    1: setIsSendingEmail\n  } = useState({\n    msg: \"Send Message\",\n    isSending: false\n  });\n  const ruduxStore = useSelector(state => state); // console.log(ruduxStore);\n\n  const name = useRef(\"\");\n  const email = useRef(\"\");\n  const msg = useRef(\"\");\n\n  function onSubmit(e) {\n    e.preventDefault();\n    const errMsg = [];\n    validator.isEmpty(name.current.value) && errMsg.push(\"Invalid Name\");\n    !validator.isEmail(email.current.value) && errMsg.push(\"Invalid Email\");\n    validator.isEmpty(msg.current.value) && errMsg.push(\"Empty Msg\");\n\n    if (errMsg.length === 0) {\n      let data = {\n        emailToAddress: \"lucut_ovidiu@yahoo.com\",\n        emailSubject: \"New Email from My PortFolio Website\",\n        emailMsg: createHTMLMail(name.current.value, email.current.value, msg.current.value)\n      };\n      setIsSendingEmail({\n        msg: \"Send Message\",\n        isSending: true\n      });\n      sendMail(data).then(data => {\n        if (data.wasError === \"true\") {\n          setIsSendingEmail({\n            msg: \"There was an internal server Error\",\n            isSending: false\n          });\n        } else {\n          setIsSendingEmail({\n            msg: \"Message Sent\",\n            isSending: false\n          });\n          name.current.value = \"\";\n          email.current.value = \"\";\n          msg.current.value = \"\";\n        }\n      });\n    } else setError(errMsg);\n  }\n\n  return __jsx(BaseLayout, {\n    tab: \"Contact\"\n  }, __jsx(\"div\", {\n    className: \"jsx-1060047105\" + \" \" + \"main_wrapper_contact\"\n  }, __jsx(\"div\", {\n    className: \"jsx-1060047105\" + \" \" + \"contact_form_main\"\n  }, __jsx(\"div\", {\n    className: \"jsx-1060047105\" + \" \" + \"contact_form_wrapper\"\n  }, __jsx(Row, null, __jsx(\"div\", {\n    role: \"alert\",\n    className: \"jsx-1060047105\" + \" \" + ((err.length > 0 ? \"alert alert-danger contact_form_err_msg\" : \"alert alert-danger contact_form_err_msg hidden\") || \"\")\n  }, err[0])), __jsx(\"h1\", {\n    className: \"jsx-1060047105\" + \" \" + \"contact_form_title p-2\"\n  }, \"Contact \", __jsx(\"span\", {\n    style: {\n      color: \"#01c851\"\n    },\n    className: \"jsx-1060047105\"\n  }, \"Me\")), __jsx(Col, {\n    sm: {\n      span: 8,\n      offset: 2\n    },\n    className: \"pt-4\"\n  }, __jsx(\"form\", {\n    onSubmit: onSubmit,\n    className: \"jsx-1060047105\"\n  }, __jsx(\"div\", {\n    className: \"jsx-1060047105\" + \" \" + \"group\"\n  }, __jsx(\"input\", {\n    type: \"text\",\n    required: true,\n    ref: name,\n    className: \"jsx-1060047105\"\n  }), __jsx(\"span\", {\n    className: \"jsx-1060047105\" + \" \" + \"bar\"\n  }), __jsx(\"label\", {\n    className: \"jsx-1060047105\"\n  }, \"Name\")), __jsx(\"div\", {\n    className: \"jsx-1060047105\" + \" \" + \"group\"\n  }, __jsx(\"input\", {\n    type: \"text\",\n    defaultValue: ruduxStore.isAuthenticaticated ? ruduxStore.loggedInUser : \"\",\n    required: true,\n    ref: email,\n    className: \"jsx-1060047105\"\n  }), __jsx(\"span\", {\n    className: \"jsx-1060047105\" + \" \" + \"bar\"\n  }), __jsx(\"label\", {\n    className: \"jsx-1060047105\"\n  }, \"Email\")), __jsx(\"textarea\", {\n    rows: \"4\",\n    placeholder: \"Message\",\n    required: true,\n    ref: msg,\n    className: \"jsx-1060047105\" + \" \" + \"input_text_area col\"\n  }), __jsx(\"br\", {\n    className: \"jsx-1060047105\"\n  }), __jsx(\"br\", {\n    className: \"jsx-1060047105\"\n  }), __jsx(Row, null, __jsx(Col, {\n    md: {\n      span: 12,\n      offset: 2\n    }\n  }, !isSendingEmail.isSending ? __jsx(\"button\", {\n    type: \"submit\",\n    className: \"jsx-1060047105\" + \" \" + \"btn btn-success\"\n  }, isSendingEmail.msg) : __jsx(Spinner, {\n    animation: \"border\",\n    role: \"status\"\n  }, __jsx(\"span\", {\n    className: \"jsx-1060047105\" + \" \" + \"sr-only\"\n  }, \"Loading...\")))))), __jsx(\"br\", {\n    className: \"jsx-1060047105\"\n  }), __jsx(\"br\", {\n    className: \"jsx-1060047105\"\n  })))), __jsx(_JSXStyle, {\n    id: \"1060047105\"\n  }, [\".main_wrapper_contact.jsx-1060047105{position:relative;min-height:100vh;background:radial-gradient( circle closest-corner at center, rgba(34,34,34,0.918), black 70% ) no-repeat;}\"]));\n};\n\nexport default Contact;","map":null,"metadata":{},"sourceType":"module"}